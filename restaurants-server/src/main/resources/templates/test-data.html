<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">üçΩÔ∏è –†–µ—Å—Ç–æ—Ä–∞–Ω—ã</a>
            <div class="navbar-nav">
                <a class="nav-link" href="/restaurants">–í—Å–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã</a>
                <a class="nav-link" href="/test-data">–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</a>
                <a class="nav-link" href="/swagger-ui.html" target="_blank">API Docs</a>
            </div>
        </div>
    </nav>

    <main class="container mt-4">
        <div class="row">
            <div class="col-md-8">
                <h1>üß™ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</h1>
                <p class="text-muted">–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞</p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>üç≥ –ö—É—Ö–Ω–∏</h5>
                    </div>
                    <div class="card-body">
                        <p>–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∫—É—Ö–Ω–∏:</p>
                        <button class="btn btn-primary" onclick="createCuisines()">
                            –°–æ–∑–¥–∞—Ç—å –∫—É—Ö–Ω–∏
                        </button>
                        <div id="cuisines-result" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>üçΩÔ∏è –†–µ—Å—Ç–æ—Ä–∞–Ω—ã</h5>
                    </div>
                    <div class="card-body">
                        <p>–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã:</p>
                        <button class="btn btn-primary" onclick="createRestaurants()">
                            –°–æ–∑–¥–∞—Ç—å —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã
                        </button>
                        <div id="restaurants-result" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col">
                <div class="card">
                    <div class="card-header">
                        <h5>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-info" onclick="loadStats()">
                            –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                        </button>
                        <div id="stats-result" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col">
                <a href="/restaurants" class="btn btn-success">
                    –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ø–∏—Å–∫—É —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
                </a>
                <a href="/swagger-ui.html" class="btn btn-outline-info ms-2" target="_blank">
                    –û—Ç–∫—Ä—ã—Ç—å API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
                </a>
            </div>
        </div>
    </div>

    <script>
        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫—É—Ö–æ–Ω—å
        const cuisinesData = [
            { name: "–ò—Ç–∞–ª—å—è–Ω—Å–∫–∞—è" },
            { name: "–Ø–ø–æ–Ω—Å–∫–∞—è" },
            { name: "–ú–µ–∫—Å–∏–∫–∞–Ω—Å–∫–∞—è" },
            { name: "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∞—è" },
            { name: "–ö–∏—Ç–∞–π—Å–∫–∞—è" },
            { name: "–ò–Ω–¥–∏–π—Å–∫–∞—è" },
            { name: "–†—É—Å—Å–∫–∞—è" },
            { name: "–ì—Ä—É–∑–∏–Ω—Å–∫–∞—è" }
        ];

        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
        const restaurantsData = [
            {
                name: "–ú–∞–º–∞ –ú–∏—è",
                address: "—É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, 15",
                phoneNumber: "+7 (495) 123-45-67",
                email: "mamamia@restaurant.ru"
            },
            {
                name: "–°—É—à–∏ –ú–∞—Å—Ç–µ—Ä",
                address: "–ø—Ä. –ù–µ–≤—Å–∫–∏–π, 28",
                phoneNumber: "+7 (812) 987-65-43",
                email: "sushi@master.ru"
            },
            {
                name: "–≠–ª—å –ü–∞—Ç–∏–æ",
                address: "—É–ª. –ê—Ä–±–∞—Ç, 42",
                phoneNumber: "+7 (495) 555-12-34",
                email: "elpatio@mexico.ru"
            },
            {
                name: "–ë–∏—Å—Ç—Ä–æ –§—Ä–∞–Ω—Å–µ",
                address: "—É–ª. –ö—É–∑–Ω–µ—Ü–∫–∏–π –º–æ—Å—Ç, 7",
                phoneNumber: "+7 (495) 777-88-99",
                email: "bistro@france.ru"
            },
            {
                name: "–î—Ä–∞–∫–æ–Ω",
                address: "—É–ª. –°–∞–¥–æ–≤–∞—è, 33",
                phoneNumber: "+7 (495) 333-22-11",
                email: "dragon@china.ru"
            }
        ];

        async function createCuisines() {
            const resultDiv = document.getElementById('cuisines-result');
            resultDiv.innerHTML = '<div class="spinner-border spinner-border-sm" role="status"></div> –°–æ–∑–¥–∞–Ω–∏–µ –∫—É—Ö–æ–Ω—å...';
            
            try {
                const promises = cuisinesData.map(cuisine => 
                    fetch('/cuisines', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(cuisine)
                    })
                );
                
                const responses = await Promise.all(promises);
                const successCount = responses.filter(r => r.ok).length;
                
                resultDiv.innerHTML = `
                    <div class="alert alert-success">
                        –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ ${successCount} –∏–∑ ${cuisinesData.length} –∫—É—Ö–æ–Ω—å
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="alert alert-danger">
                        –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫—É—Ö–æ–Ω—å: ${error.message}
                    </div>
                `;
            }
        }

        async function createRestaurants() {
            const resultDiv = document.getElementById('restaurants-result');
            resultDiv.innerHTML = '<div class="spinner-border spinner-border-sm" role="status"></div> –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤...';
            
            try {
                const promises = restaurantsData.map(restaurant => 
                    fetch('/restaurant', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(restaurant)
                    })
                );
                
                const responses = await Promise.all(promises);
                const successCount = responses.filter(r => r.ok).length;
                
                resultDiv.innerHTML = `
                    <div class="alert alert-success">
                        –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ ${successCount} –∏–∑ ${restaurantsData.length} —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="alert alert-danger">
                        –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤: ${error.message}
                    </div>
                `;
            }
        }

        async function loadStats() {
            const resultDiv = document.getElementById('stats-result');
            resultDiv.innerHTML = '<div class="spinner-border spinner-border-sm" role="status"></div> –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...';
            
            try {
                const [restaurantsRes, cuisinesRes] = await Promise.all([
                    fetch('/restaurant?size=1000'),
                    fetch('/cuisines?size=1000')
                ]);
                
                const restaurants = await restaurantsRes.json();
                const cuisines = await cuisinesRes.json();
                
                resultDiv.innerHTML = `
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h3 class="text-primary">${restaurants.content ? restaurants.content.length : 0}</h3>
                                    <p class="mb-0">–†–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h3 class="text-success">${cuisines.content ? cuisines.content.length : 0}</h3>
                                    <p class="mb-0">–ö—É—Ö–æ–Ω—å</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="alert alert-danger">
                        –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: ${error.message}
                    </div>
                `;
            }
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', loadStats);
    </script>

    <footer class="bg-light text-center text-muted py-3 mt-5">
        <div class="container">
            <p>&copy; 2024 –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º–∏</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/app.js"></script>
</body>
</html>
